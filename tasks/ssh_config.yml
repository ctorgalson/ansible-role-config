---
# - include_vars: vars/vault.yml
# 
# - name: Template ssh config file to system.
#   template:
#     src: ssh_config.j2
#     dest: "{{ config_home_dir }}/{{ item.user }}/.ssh/config"
#     owner: "{{ item.user }}"
#     group: "{{ item.group }}"
#     backup: yes
#   with_items: "{{ config_users | default([]) }}"
#   when: config_ssh_config

- name: Copy ssh config file into place (Ansible should decrypt it if needed).
  copy:
    src: "{{ config_ssh_config_src_path }}"
    dest: "{{ config_home_dir }}/{{ item.user }}/.ssh/config"
    owner: "{{ item.user }}"
    group: "{{ item.group }}"
  with_items: "{{ config_users }}"
  when: "{{ config_ssh_config }}"
